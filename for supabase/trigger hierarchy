-- Trigger to maintain airport hierarchy
CREATE OR REPLACE FUNCTION maintain_airport_hierarchy()
RETURNS TRIGGER AS $$
BEGIN
    -- If country doesn't exist in our standardization, mark for review
    IF NEW.country NOT IN ('USA', 'UK', 'UAE', 'Canada', 'Australia', 'Japan') THEN
        RAISE NOTICE 'New country added: %', NEW.country;
    END IF;
    
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER airport_hierarchy_trigger
BEFORE INSERT ON dim_airport
FOR EACH ROW
EXECUTE FUNCTION maintain_airport_hierarchy();
